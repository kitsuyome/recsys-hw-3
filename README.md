# RecSys, Домашнее задание № 3

## Цель

Данный репозиторий содержит код для выполнения домашнего задания по рекомендательным системам. Проект реализует двухступенчатую систему рекомендаций, которая включает:
- Генерацию кандидатов с использованием трёх моделей первого уровня: эвристической модели, модели матричной факторизации и простой нейронной модели.
- Финальное ранжирование кандидатов с использованием бустингового алгоритма

Кроме того, в проекте реализован сбор осмысленных признаков (feature engineering) и оценка важности признаков с помощью SHAP, а также вычисление метрик разнообразия выдачи.

## Установка

Для установки зависимостей выполните следующие шаги:

```bash
   git clone https://github.com/kitsuyome/recsys-hw-3.git
   cd recsys-hw-3
   !pip install -r requirements.txt
```
## Использование

- **main.ipynb** – основной ноутбук, демонстрирующий:
  - Загрузку и предварительную обработку данных (разбиение на train/valid/test).
  - Обучение моделей первого уровня (эвристическая модель, модель матричной факторизации и нейронная модель).
  - Сбор признаков по пользователю, айтему и их взаимодействию.
  - Обучение финального ранкера
  - Генерацию и оценку финальных рекомендаций

- **models.py** – содержит определения классов моделей первого уровня:
  - `HeuristicModel`
  - `MatrixFactorization`
  - `NeuralRecSysModel`

- **utils.py** – содержит вспомогательные функции, например:
  - Функции для расчёта метрик (diversity, RBO).
  - Функции для пакетного расчёта предсказаний и добавления скоров моделей в DataFrame.

Чтобы запустить весь процесс, выполните следующие шаги:
1. Откройте файл `main.ipynb` в Jupyter Notebook или JupyterLab.
2. Выполните ячейки по порядку для воспроизведения полного пайплайна от подготовки данных до инференса финальных рекомендаций.
